# DocVault v2.0 Implementation Checklist

**Version**: 2.0.0  
**Status**: Planning  
**Start Date**: TBD  
**Target Completion**: TBD

---

## Overview

This checklist tracks the implementation progress of DocVault v2.0. Each phase contains actionable tasks that should be checked off as completed.

**Legend**:
- [ ] Not started
- [x] Completed
- [~] In progress
- [!] Blocked

---

## Phase 1: Database Schema & Migration ⏳

**Duration**: 1 week  
**Start Date**: ___  
**Completion Date**: ___

### 1.1: Create v2 Schema File
- [ ] Create `src/doc_vault/database/sql/schema_v2.sql`
- [ ] Remove `external_id` column from organizations table
- [ ] Remove `name` column from organizations table
- [ ] Remove `external_id` from agents table
- [ ] Remove `name`, `email`, `agent_type` from agents table
- [ ] Add `prefix` column to documents table (VARCHAR(500))
- [ ] Add `path` column to documents table (VARCHAR(1000))
- [ ] Remove index `idx_organizations_external_id`
- [ ] Remove index `idx_agents_external_id`
- [ ] Add index `idx_documents_prefix` on documents(prefix)
- [ ] Add index `idx_documents_path` using GIN with trigram ops
- [ ] Update foreign key constraints for new structure
- [ ] Update `update_updated_at_column()` trigger if needed
- [ ] Verify all triggers work with new schema

### 1.2: Create Migration Script
- [ ] Create `src/doc_vault/database/sql/migrate_v1_to_v2.sql`
- [ ] Add header comments with migration instructions
- [ ] Create backup recommendation section
- [ ] Map external_id values to maintain relationships
- [ ] Drop external_id columns after mapping
- [ ] Drop name, email, agent_type columns from agents
- [ ] Drop name column from organizations
- [ ] Add prefix column to documents
- [ ] Add path column to documents
- [ ] Update indexes (drop old, create new)
- [ ] Create rollback script
- [ ] Add data validation queries at end
- [ ] Test migration on sample database

### 1.3: Update Database Initialization
- [ ] Update `src/doc_vault/database/init_db.py`
- [ ] Add schema version detection logic
- [ ] Add automatic migration execution option
- [ ] Update `initialize_database()` function
- [ ] Add validation checks after initialization
- [ ] Update error handling for migration failures
- [ ] Add logging for migration progress
- [ ] Test fresh v2 database creation
- [ ] Test migration execution

### 1.4: Testing
- [ ] Create test database for v1 schema
- [ ] Populate with sample data
- [ ] Run migration script
- [ ] Verify all data preserved
- [ ] Verify foreign keys intact
- [ ] Test index performance
- [ ] Test rollback procedure
- [ ] Document any issues found
- [ ] Create migration test suite

**Phase 1 Sign-off**: ___________  
**Date**: ___________

---

## Phase 2: Repository Layer Updates ⏳

**Duration**: 1 week  
**Start Date**: ___  
**Completion Date**: ___

### 2.1: Update Base Repository
- [ ] Update `src/doc_vault/database/repositories/base.py`
- [ ] Remove `get_by_external_id()` method
- [ ] Update `get_by_id()` to use UUID directly
- [ ] Update error messages to reference UUID
- [ ] Add `delete()` base method
- [ ] Update type hints for UUID
- [ ] Add docstrings for new methods
- [ ] Test base repository changes

### 2.2: Update Organization Repository
- [ ] Update `src/doc_vault/database/repositories/organization.py`
- [ ] Update `create()` signature: `id: UUID` parameter
- [ ] Remove `get_by_external_id()` method
- [ ] Update `get_by_id()` to use id directly
- [ ] Remove `external_id` from INSERT query
- [ ] Remove `name` from INSERT query
- [ ] Update `update()` to remove name field
- [ ] Implement `delete(org_id: UUID)` method
- [ ] Add cascade delete warning/check
- [ ] Update all SQL queries
- [ ] Update docstrings
- [ ] Write unit tests for new methods
- [ ] Test organization CRUD operations

### 2.3: Update Agent Repository
- [ ] Update `src/doc_vault/database/repositories/agent.py`
- [ ] Update `create()` signature: `id: UUID` parameter
- [ ] Remove `get_by_external_id()` method
- [ ] Update `get_by_id()` to use id directly
- [ ] Remove `external_id`, `name`, `email`, `agent_type` from INSERT
- [ ] Update `update()` to remove name, email, agent_type
- [ ] Implement `delete(agent_id: UUID)` method
- [ ] Implement `remove_from_organization(agent_id: UUID)` method
- [ ] Update `get_by_organization()` query
- [ ] Update `list_agents()` query
- [ ] Add cascade delete handling
- [ ] Update all SQL queries
- [ ] Update docstrings
- [ ] Write unit tests for new methods
- [ ] Test agent CRUD operations

### 2.4: Update Document Repository
- [ ] Update `src/doc_vault/database/repositories/document.py`
- [ ] Add `prefix: Optional[str]` parameter to `create()`
- [ ] Add `path: Optional[str]` parameter to `create()`
- [ ] Auto-generate path from prefix + name
- [ ] Update INSERT query with prefix and path
- [ ] Update `update()` to handle prefix/path changes
- [ ] Implement `list_by_prefix(prefix: str, org_id: UUID)` method
- [ ] Implement `list_recursive(prefix: str, org_id: UUID, max_depth: Optional[int])` method
- [ ] Update `search()` to include prefix filtering
- [ ] Update `list_documents()` with prefix parameter
- [ ] Update all agent_id/org_id queries to use UUID directly
- [ ] Optimize prefix queries with proper LIKE patterns
- [ ] Add depth calculation for recursive queries
- [ ] Update all SQL queries
- [ ] Update docstrings
- [ ] Write unit tests for prefix operations
- [ ] Write unit tests for recursive listing
- [ ] Test performance with large datasets

### 2.5: Update Version Repository
- [ ] Update `src/doc_vault/database/repositories/version.py`
- [ ] Update `create()` to use UUID for agent_id
- [ ] Update `get_by_document()` to use UUIDs
- [ ] Update `get_by_version_number()` to use UUIDs
- [ ] Add `delete_version(version_id: UUID)` method
- [ ] Add version cleanup for replaced versions
- [ ] Update all SQL queries
- [ ] Update docstrings
- [ ] Write unit tests

### 2.6: Update ACL Repository
- [ ] Update `src/doc_vault/database/repositories/acl.py`
- [ ] Update `create()` to use UUIDs
- [ ] Update `get_by_document()` to use UUIDs
- [ ] Update `get_by_agent()` to use UUIDs
- [ ] Implement `get_all_permissions(document_id: UUID)` method
- [ ] Implement `set_permissions(document_id: UUID, permissions: List)` method
- [ ] Add bulk permission operations
- [ ] Update `delete()` method
- [ ] Update `check_permission()` to use UUIDs
- [ ] Update all SQL queries
- [ ] Update docstrings
- [ ] Write unit tests for bulk operations

**Phase 2 Sign-off**: ___________  
**Date**: ___________

---

## Phase 3: Schema Models & Validation ⏳

**Duration**: 3 days  
**Start Date**: ___  
**Completion Date**: ___

### 3.1: Update Organization Schema
- [ ] Update `src/doc_vault/database/schemas/organization.py`
- [ ] Remove `external_id` field from Organization model
- [ ] Remove `name` field from Organization model
- [ ] Change `id` field to accept external UUID (remove default)
- [ ] Update field validators
- [ ] Update docstrings
- [ ] Update example usage in docstrings
- [ ] Test schema validation

### 3.2: Update Agent Schema
- [ ] Update `src/doc_vault/database/schemas/agent.py`
- [ ] Remove `external_id` field from Agent model
- [ ] Remove `name` field
- [ ] Remove `email` field
- [ ] Remove `agent_type` field
- [ ] Change `id` field to accept external UUID
- [ ] Update field validators
- [ ] Update docstrings
- [ ] Test schema validation

### 3.3: Update Document Schema
- [ ] Update `src/doc_vault/database/schemas/document.py`
- [ ] Add `prefix` field: Optional[str]
- [ ] Add `path` field: Optional[str]
- [ ] Add path format validator
- [ ] Add prefix format validator
- [ ] Update `created_by` type to UUID
- [ ] Update `updated_by` type to UUID
- [ ] Update `organization_id` type to UUID
- [ ] Update docstrings
- [ ] Add examples for prefix usage
- [ ] Test schema validation

### 3.4: Create New Permission Schema
- [ ] Create or update Permission model
- [ ] Add permission type enum (READ, WRITE, DELETE, SHARE, ADMIN)
- [ ] Add agent_id field (UUID)
- [ ] Add granted_by field (UUID)
- [ ] Add granted_at field (datetime)
- [ ] Add expires_at field (Optional[datetime])
- [ ] Add metadata field (Optional[Dict])
- [ ] Add validators
- [ ] Add docstrings
- [ ] Create PermissionSet model for bulk operations
- [ ] Test permission models

### 3.5: Update Version Schema
- [ ] Update `src/doc_vault/database/schemas/version.py`
- [ ] Update `created_by` type to UUID
- [ ] Update `document_id` type to UUID
- [ ] Update docstrings
- [ ] Test schema validation

### 3.6: Update ACL Schema
- [ ] Update `src/doc_vault/database/schemas/acl.py`
- [ ] Update `agent_id` type to UUID
- [ ] Update `document_id` type to UUID
- [ ] Update `granted_by` type to UUID
- [ ] Add bulk operation models
- [ ] Update docstrings
- [ ] Test schema validation

**Phase 3 Sign-off**: ___________  
**Date**: ___________

---

## Phase 4: Organization & Agent Management ⏳

**Duration**: 4 days  
**Start Date**: ___  
**Completion Date**: ___

### 4.1: Update Organization Service Methods
- [ ] Update `register_organization()` signature: `id: UUID`
- [ ] Remove name parameter
- [ ] Update service logic to use UUID directly
- [ ] Implement `delete_organization(org_id: UUID)` method
- [ ] Add cascade delete check (count documents)
- [ ] Add cascade delete check (count agents)
- [ ] Add `force` parameter for cascade delete
- [ ] Add soft delete option
- [ ] Update error messages
- [ ] Update docstrings
- [ ] Test organization registration with UUID
- [ ] Test organization deletion

### 4.2: Update Agent Service Methods
- [ ] Update `register_agent()` signature: `id: UUID`
- [ ] Remove name, email, agent_type parameters
- [ ] Update service logic to use UUID directly
- [ ] Implement `remove_agent(agent_id: UUID)` method
- [ ] Implement `delete_agent(agent_id: UUID)` as alias
- [ ] Add cascade delete check (count documents)
- [ ] Add cascade delete check (count ACLs)
- [ ] Add `force` parameter for cascade delete
- [ ] Update error messages
- [ ] Update docstrings
- [ ] Test agent registration with UUID
- [ ] Test agent removal

### 4.3: Update Core SDK Methods
- [ ] Update `src/doc_vault/core.py`
- [ ] Add `delete_organization(org_id: UUID)` method
- [ ] Add `remove_agent(agent_id: UUID)` method
- [ ] Update `register_organization()` signature
- [ ] Update `register_agent()` signature
- [ ] Remove name parameters
- [ ] Update docstrings with examples
- [ ] Update error handling
- [ ] Add type hints

### 4.4: Testing
- [ ] Test organization creation with external UUID
- [ ] Test organization deletion (empty org)
- [ ] Test organization deletion (with documents) - should fail
- [ ] Test organization deletion with force=True
- [ ] Test agent creation with external UUID
- [ ] Test agent removal (no documents)
- [ ] Test agent removal (with documents) - should fail
- [ ] Test agent removal with force=True
- [ ] Test cascade delete behavior
- [ ] Test soft delete scenarios
- [ ] Test error conditions
- [ ] Integration tests for org/agent lifecycle

**Phase 4 Sign-off**: ___________  
**Date**: ___________

---

## Phase 5: Document Prefix & Hierarchical Support ⏳

**Duration**: 1 week  
**Start Date**: ___  
**Completion Date**: ___

### 5.1: Add Path Utilities
- [ ] Create `src/doc_vault/utils/__init__.py`
- [ ] Create `src/doc_vault/utils/path.py`
- [ ] Implement `normalize_prefix(prefix: str) -> str`
- [ ] Implement `validate_prefix(prefix: str) -> bool`
- [ ] Implement `calculate_depth(path: str) -> int`
- [ ] Implement `parse_path(path: str) -> List[str]`
- [ ] Implement `join_path(*parts: str) -> str`
- [ ] Implement `is_under_prefix(path: str, prefix: str) -> bool`
- [ ] Add docstrings with examples
- [ ] Write unit tests for all utility functions
- [ ] Test edge cases (empty, special chars, long paths)

### 5.2: Update Document Repository
- [ ] Add prefix parameter to `create()` method
- [ ] Auto-generate path from prefix + name
- [ ] Validate prefix format before insert
- [ ] Update INSERT query with prefix and path
- [ ] Add prefix normalization
- [ ] Update storage path generation logic
- [ ] Add prefix filtering to existing query methods
- [ ] Test prefix storage and retrieval

### 5.3: Update Document Service
- [ ] Add prefix parameter to `create_document()` method
- [ ] Add prefix validation logic
- [ ] Update storage organization to use prefix
- [ ] Handle prefix changes on document update
- [ ] Update metadata to include path info
- [ ] Test hierarchical document creation

### 5.4: Testing
- [ ] Test prefix validation (valid formats)
- [ ] Test prefix validation (invalid formats)
- [ ] Test path generation
- [ ] Test hierarchical organization (multiple levels)
- [ ] Test special characters in prefixes
- [ ] Test very long prefixes (edge case)
- [ ] Test empty/null prefix (backwards compat)
- [ ] Test prefix in storage paths
- [ ] Test prefix filtering in queries
- [ ] Performance test with many prefixes

**Phase 5 Sign-off**: ___________  
**Date**: ___________

---

## Phase 6: Enhanced Upload System ⏳

**Duration**: 1 week  
**Start Date**: ___  
**Completion Date**: ___

### 6.1: Update Storage Backend
- [ ] Update `src/doc_vault/storage/s3_client.py`
- [ ] Implement `upload_bytes(bucket: str, key: str, data: bytes)` method
- [ ] Implement `upload_stream(bucket: str, key: str, stream: BinaryIO)` method
- [ ] Update `upload_file()` for consistency
- [ ] Add content type detection for bytes/streams
- [ ] Calculate file size for all input types
- [ ] Update error handling
- [ ] Add docstrings
- [ ] Test bytes upload
- [ ] Test stream upload
- [ ] Test large file streaming

### 6.2: Create Upload Handler
- [ ] Create `src/doc_vault/services/upload_handler.py`
- [ ] Create `UploadHandler` class
- [ ] Implement `detect_input_type()` method
- [ ] Implement `upload_from_path()` method
- [ ] Implement `upload_from_bytes()` method
- [ ] Implement `upload_from_stream()` method
- [ ] Add file size calculation for all types
- [ ] Add checksum generation (SHA256)
- [ ] Add content type detection
- [ ] Handle streaming for large files (>100MB)
- [ ] Add progress tracking support
- [ ] Add error handling
- [ ] Add docstrings
- [ ] Test all input type handlers
- [ ] Test checksum calculation
- [ ] Test large file handling

### 6.3: Update Document Service
- [ ] Update `upload()` method signature
- [ ] Change `file_path` to `file_path: Union[str, bytes, BinaryIO]`
- [ ] Add `file_type: str` parameter
- [ ] Add `replace_current_version: bool` parameter
- [ ] Integrate UploadHandler
- [ ] Implement replace logic: delete old version, create new
- [ ] Update metadata tracking
- [ ] Update version numbering for replacements
- [ ] Add error handling for type detection
- [ ] Update docstrings
- [ ] Test upload with file path
- [ ] Test upload with bytes
- [ ] Test upload with stream
- [ ] Test replace_current_version=True
- [ ] Test replace_current_version=False

### 6.4: Update Core SDK Upload
- [ ] Update `upload()` in `src/doc_vault/core.py`
- [ ] Update signature with Union type
- [ ] Add `file_type` parameter
- [ ] Add `replace_current_version` parameter
- [ ] Update type hints
- [ ] Update docstrings with examples for all types
- [ ] Add usage examples in docstring
- [ ] Update error messages
- [ ] Test SDK upload method

### 6.5: Testing
- [ ] Test upload with file path (string)
- [ ] Test upload with bytes
- [ ] Test upload with file-like object (BinaryIO)
- [ ] Test upload with io.BytesIO
- [ ] Test large file streaming (>100MB)
- [ ] Test replace_current_version=True
- [ ] Test replace_current_version=False
- [ ] Test file type detection
- [ ] Test checksum validation
- [ ] Test error handling (invalid input type)
- [ ] Test error handling (file not found)
- [ ] Test error handling (storage failure)
- [ ] Performance test with different input types

**Phase 6 Sign-off**: ___________  
**Date**: ___________

---

## Phase 7: Document Listing & Retrieval ⏳

**Duration**: 1 week  
**Start Date**: ___  
**Completion Date**: ___

### 7.1: Implement list_docs()
- [ ] Create `list_by_prefix()` in document repository
- [ ] Add `prefix: Optional[str]` parameter
- [ ] Add `recursive: bool` parameter
- [ ] Add `max_depth: Optional[int]` parameter
- [ ] Add `permission_check: bool` parameter
- [ ] Add pagination (limit/offset)
- [ ] Implement flat listing (recursive=False)
- [ ] Implement recursive listing (recursive=True)
- [ ] Add permission filtering logic
- [ ] Optimize SQL query with proper indexes
- [ ] Add result ordering
- [ ] Test flat listing
- [ ] Test recursive listing
- [ ] Test permission filtering
- [ ] Test pagination

### 7.2: Implement Recursive Search
- [ ] Create recursive query builder helper
- [ ] Implement depth calculation in query
- [ ] Handle max_depth parameter (None = unlimited)
- [ ] Optimize for large result sets
- [ ] Add query result caching (optional)
- [ ] Add depth field to results
- [ ] Test with various depths
- [ ] Test with max_depth limits
- [ ] Test performance with deep hierarchies
- [ ] Test performance with wide hierarchies

### 7.3: Implement get_document_details()
- [ ] Create method in document repository
- [ ] Add `include_versions: bool` parameter
- [ ] Add `include_permissions: bool` parameter
- [ ] Query document metadata
- [ ] Conditionally query versions
- [ ] Conditionally query permissions (owner check)
- [ ] Combine data from multiple sources
- [ ] Optimize with single query if possible
- [ ] Format results consistently
- [ ] Test basic document details
- [ ] Test with include_versions=True
- [ ] Test with include_permissions=True (owner)
- [ ] Test with include_permissions=True (non-owner) - should exclude

### 7.4: Update Document Service
- [ ] Add `list_docs()` service method
- [ ] Add permission checking logic
- [ ] Handle pagination
- [ ] Add result formatting
- [ ] Add `get_document_details()` service method
- [ ] Add owner validation for include_permissions
- [ ] Update error handling
- [ ] Add docstrings

### 7.5: Update Core SDK
- [ ] Add `list_docs()` to `src/doc_vault/core.py`
- [ ] Add all parameters with proper defaults
- [ ] Add type hints
- [ ] Add comprehensive docstring with examples
- [ ] Add `get_document_details()` to core.py
- [ ] Add type hints
- [ ] Add comprehensive docstring
- [ ] Update error handling

### 7.6: Testing
- [ ] Test flat listing (recursive=False)
- [ ] Test recursive listing (recursive=True)
- [ ] Test max_depth=1, 2, 3, 10
- [ ] Test max_depth=None (unlimited)
- [ ] Test permission filtering (permission_check=True)
- [ ] Test without permission filtering (permission_check=False)
- [ ] Test pagination (various limit/offset combinations)
- [ ] Test empty prefix
- [ ] Test non-existent prefix
- [ ] Test get_document_details() basic
- [ ] Test get_document_details() with versions
- [ ] Test get_document_details() with permissions (owner)
- [ ] Test get_document_details() with permissions (non-owner)
- [ ] Performance test with 1000 documents
- [ ] Performance test with deep hierarchy (10 levels)
- [ ] Performance test with wide hierarchy (100 items per level)

**Phase 7 Sign-off**: ___________  
**Date**: ___________

---

## Phase 8: Permissions Refactoring ⏳

**Duration**: 1 week  
**Start Date**: ___  
**Completion Date**: ___

### 8.1: Implement get_permissions()
- [ ] Create method in ACL repository
- [ ] Query all permissions for document
- [ ] Add agent filtering (optional)
- [ ] Add permission type filtering (optional)
- [ ] Handle expiration checking
- [ ] Format results as Permission objects
- [ ] Add sorting (by granted_at)
- [ ] Test get_permissions() for document
- [ ] Test with agent filter
- [ ] Test with expired permissions
- [ ] Test with no permissions

### 8.2: Implement set_permissions()
- [ ] Create method in ACL repository
- [ ] Support bulk permission updates
- [ ] Add permission granting logic (INSERT)
- [ ] Add permission revocation logic (DELETE)
- [ ] Add permission update logic (UPDATE)
- [ ] Handle expiration dates
- [ ] Validate permission types
- [ ] Add transaction support (all or nothing)
- [ ] Test granting new permissions
- [ ] Test revoking permissions
- [ ] Test updating permissions
- [ ] Test bulk operations
- [ ] Test with expiration dates
- [ ] Test transaction rollback on error

### 8.3: Update Access Service
- [ ] Add `get_permissions()` service method
- [ ] Add authorization check (ADMIN or owner)
- [ ] Add `set_permissions()` service method
- [ ] Add authorization check (ADMIN or SHARE)
- [ ] Update internal permission checking to use new methods
- [ ] Remove `share()` service method
- [ ] Remove `revoke()` service method
- [ ] Remove `check_permission()` service method
- [ ] Update error handling
- [ ] Update docstrings

### 8.4: Update Core SDK
- [ ] Add `get_permissions()` to `src/doc_vault/core.py`
- [ ] Add `set_permissions()` to core.py
- [ ] Remove `share()` method
- [ ] Remove `revoke()` method
- [ ] Remove `check_permission()` method
- [ ] Remove `list_accessible_documents()` method
- [ ] Remove `get_document_permissions()` method
- [ ] Update type hints
- [ ] Add comprehensive docstrings
- [ ] Add usage examples
- [ ] Update error handling

### 8.5: Update Permission Models
- [ ] Create/update `Permission` model
- [ ] Add `PermissionType` enum
- [ ] Add fields: agent_id, permission_type, granted_by, granted_at, expires_at, metadata
- [ ] Create `PermissionSet` model for bulk operations
- [ ] Add validators
- [ ] Add docstrings
- [ ] Test model validation

### 8.6: Testing
- [ ] Test get_permissions() for document with multiple permissions
- [ ] Test get_permissions() for document with no permissions
- [ ] Test get_permissions() with expired permissions
- [ ] Test get_permissions() authorization (owner)
- [ ] Test get_permissions() authorization (non-owner) - should fail
- [ ] Test set_permissions() grant single permission
- [ ] Test set_permissions() grant multiple permissions
- [ ] Test set_permissions() revoke single permission
- [ ] Test set_permissions() revoke multiple permissions
- [ ] Test set_permissions() mixed grant/revoke
- [ ] Test set_permissions() with expiration
- [ ] Test set_permissions() authorization
- [ ] Test permission expiration enforcement
- [ ] Test transaction rollback on error
- [ ] Integration test: full permission lifecycle

**Phase 8 Sign-off**: ___________  
**Date**: ___________

---

## Phase 9: Core SDK Integration ⏳

**Duration**: 1 week  
**Start Date**: ___  
**Completion Date**: ___

### 9.1: Update core.py
- [ ] Review all new methods integrated
- [ ] Remove all deprecated methods
- [ ] Update all method signatures
- [ ] Update error handling throughout
- [ ] Update type hints throughout
- [ ] Add comprehensive docstrings to all methods
- [ ] Add usage examples to docstrings
- [ ] Ensure consistent error messages
- [ ] Add method categorization comments
- [ ] Review code for consistency

### 9.2: Update __init__.py
- [ ] Update `src/doc_vault/__init__.py`
- [ ] Update version to "2.0.0"
- [ ] Update exports list
- [ ] Remove deprecated exports
- [ ] Add new model exports
- [ ] Add deprecation warnings if needed
- [ ] Update module docstring

### 9.3: Update Exceptions
- [ ] Review `src/doc_vault/exceptions.py`
- [ ] Add new exception types if needed
- [ ] Update error messages
- [ ] Add detailed error context
- [ ] Ensure all exceptions have proper docstrings
- [ ] Test exception hierarchy

### 9.4: Integration Testing
- [ ] Test full upload workflow (all input types)
- [ ] Test full retrieval workflow (list + details)
- [ ] Test permission workflows (get/set)
- [ ] Test organization/agent management lifecycle
- [ ] Test hierarchical document organization
- [ ] Test recursive document listing
- [ ] Test error scenarios (all major errors)
- [ ] Test edge cases
- [ ] Test concurrent operations
- [ ] Test transaction handling
- [ ] Integration test: complete document lifecycle
- [ ] Integration test: multi-org isolation
- [ ] Integration test: complex permission scenarios

### 9.5: Performance Testing
- [ ] Benchmark upload performance (file, bytes, stream)
- [ ] Benchmark download performance
- [ ] Benchmark list_docs() performance
- [ ] Benchmark recursive search performance (depth 1-10)
- [ ] Benchmark get_permissions() performance
- [ ] Benchmark set_permissions() performance
- [ ] Test with 1,000 documents
- [ ] Test with 10,000 documents
- [ ] Test with 100 concurrent operations
- [ ] Identify performance bottlenecks
- [ ] Optimize critical paths
- [ ] Document performance characteristics

**Phase 9 Sign-off**: ___________  
**Date**: ___________

---

## Phase 10: Testing & Quality Assurance ⏳

**Duration**: 1 week  
**Start Date**: ___  
**Completion Date**: ___

### 10.1: Unit Tests
- [ ] Review all repository test files
- [ ] Update all repository tests for UUID changes
- [ ] Add tests for new repository methods
- [ ] Review all service test files
- [ ] Update all service tests for UUID changes
- [ ] Add tests for new service methods
- [ ] Review all SDK test files
- [ ] Update all SDK tests for new API
- [ ] Add tests for new SDK methods
- [ ] Add tests for edge cases
- [ ] Ensure >80% code coverage
- [ ] Fix any failing tests

### 10.2: Integration Tests
- [ ] Test complete upload-download workflow
- [ ] Test complete permission workflow
- [ ] Test cross-feature interactions
- [ ] Test error propagation
- [ ] Test transaction handling
- [ ] Test rollback scenarios
- [ ] Test multi-org scenarios
- [ ] Test concurrent access
- [ ] Fix any integration issues

### 10.3: Migration Tests
- [ ] Create v1 test database with sample data
- [ ] Run migration script
- [ ] Verify all organizations migrated
- [ ] Verify all agents migrated
- [ ] Verify all documents migrated
- [ ] Verify all ACLs migrated
- [ ] Verify all versions migrated
- [ ] Verify foreign key integrity
- [ ] Test v2 operations on migrated data
- [ ] Test rollback script
- [ ] Document migration issues

### 10.4: Performance Tests
- [ ] Benchmark upload (small files <1MB)
- [ ] Benchmark upload (large files >100MB)
- [ ] Benchmark list_docs (100, 1000, 10000 docs)
- [ ] Benchmark recursive search (depth 1-10)
- [ ] Benchmark get_permissions (1-100 permissions)
- [ ] Benchmark set_permissions (1-100 permissions)
- [ ] Test with large datasets
- [ ] Test concurrent operations (10, 50, 100 concurrent)
- [ ] Identify performance regressions vs v1
- [ ] Optimize critical paths if needed
- [ ] Document performance results

### 10.5: Security Tests
- [ ] Test permission enforcement
- [ ] Test organization isolation
- [ ] Test input validation (SQL injection attempts)
- [ ] Test path traversal attempts
- [ ] Test access control bypasses
- [ ] Test expired permission enforcement
- [ ] Test privilege escalation attempts
- [ ] Review all user inputs for validation
- [ ] Security audit of permission system
- [ ] Document security findings

### 10.6: Compatibility Tests
- [ ] Test on Python 3.10
- [ ] Test on Python 3.11
- [ ] Test on Python 3.12
- [ ] Test on Python 3.13
- [ ] Test on Windows
- [ ] Test on Linux
- [ ] Test on macOS
- [ ] Test with PostgreSQL 14
- [ ] Test with PostgreSQL 15
- [ ] Test with PostgreSQL 16
- [ ] Test with MinIO
- [ ] Test with AWS S3
- [ ] Document compatibility matrix

**Phase 10 Sign-off**: ___________  
**Date**: ___________

---

## Phase 11: Documentation & Examples ⏳

**Duration**: 4 days  
**Start Date**: ___  
**Completion Date**: ___

### 11.1: Update API Documentation
- [ ] Update `docs/API.md`
- [ ] Document all new methods
- [ ] Update signatures for changed methods
- [ ] Remove documentation for deleted methods
- [ ] Add code examples for each method
- [ ] Update parameter descriptions
- [ ] Add return value descriptions
- [ ] Add exception descriptions
- [ ] Add usage notes and best practices
- [ ] Review for accuracy

### 11.2: Create Migration Guide
- [ ] Create `docs/MIGRATION_V1_TO_V2.md`
- [ ] Document all breaking changes
- [ ] Provide before/after code examples
- [ ] Create step-by-step migration instructions
- [ ] Document database migration process
- [ ] Create migration checklist for users
- [ ] Add troubleshooting section
- [ ] Add FAQ section
- [ ] Review for completeness

### 11.3: Update README
- [ ] Update `README.md`
- [ ] Update feature list
- [ ] Update quick start example
- [ ] Update API examples
- [ ] Add v2.0 highlights section
- [ ] Update configuration section (if changed)
- [ ] Update installation instructions
- [ ] Update requirements
- [ ] Add link to migration guide
- [ ] Review for accuracy

### 11.4: Update Examples
- [ ] Update `examples/basic_usage.py` for v2 API
- [ ] Update `examples/access_control.py` for new permission API
- [ ] Update `examples/versioning.py` for new upload API
- [ ] Update `examples/multi_org.py` for UUID-based IDs
- [ ] Create `examples/hierarchical_documents.py`
- [ ] Create `examples/flexible_upload.py`
- [ ] Update `examples/README.md`
- [ ] Test all examples
- [ ] Add comments explaining v2 features
- [ ] Review for clarity

### 11.5: Update CHANGELOG
- [ ] Update `CHANGELOG.md`
- [ ] Add v2.0.0 section
- [ ] Document all breaking changes
- [ ] Document all new features
- [ ] Document all removed features
- [ ] Add migration notes
- [ ] Add upgrade instructions
- [ ] Add contributor acknowledgments
- [ ] Review for completeness

### 11.6: Create Docstrings
- [ ] Review all function docstrings in core.py
- [ ] Update all parameter descriptions
- [ ] Update all return value descriptions
- [ ] Update all exception descriptions
- [ ] Add usage examples to docstrings
- [ ] Add notes about v2 changes
- [ ] Review service layer docstrings
- [ ] Review repository layer docstrings
- [ ] Run docstring linter
- [ ] Fix any docstring issues

**Phase 11 Sign-off**: ___________  
**Date**: ___________

---

## Phase 12: Release Preparation ⏳

**Duration**: 3 days  
**Start Date**: ___  
**Completion Date**: ___

### 12.1: Final Testing
- [ ] Run complete test suite
- [ ] Fix any failing tests
- [ ] Test all example scripts
- [ ] Test migration process end-to-end
- [ ] Manual testing of key features
- [ ] Smoke testing on fresh install
- [ ] Test installation from wheel
- [ ] Test in clean environment
- [ ] Review test coverage report
- [ ] Document any known issues

### 12.2: Version Bumping
- [ ] Update version in `src/doc_vault/__init__.py` to "2.0.0"
- [ ] Update version in `pyproject.toml` to "2.0.0"
- [ ] Update version in `docs/API.md`
- [ ] Update version in `README.md`
- [ ] Search for other version references
- [ ] Commit version changes

### 12.3: Release Notes
- [ ] Create `RELEASE_NOTES_v2.0.md`
- [ ] Write executive summary
- [ ] Highlight breaking changes prominently
- [ ] List all new features
- [ ] List removed features
- [ ] Provide upgrade instructions
- [ ] Add contributor acknowledgments
- [ ] Add known issues section
- [ ] Review and proofread

### 12.4: Package Building
- [ ] Clean build artifacts (`rm -rf dist/ build/`)
- [ ] Build wheel package (`python -m build`)
- [ ] Build source distribution
- [ ] Test wheel installation locally
- [ ] Validate package contents
- [ ] Check package metadata
- [ ] Test import after installation
- [ ] Run tests with installed package

### 12.5: Git Tagging
- [ ] Commit all final changes
- [ ] Create git tag: `git tag -a v2.0.0 -m "DocVault v2.0.0"`
- [ ] Push commits: `git push origin main`
- [ ] Push tags: `git push origin v2.0.0`
- [ ] Create GitHub release from tag
- [ ] Upload release notes to GitHub
- [ ] Attach wheel and source dist to release

### 12.6: PyPI Publishing
- [ ] Configure PyPI credentials
- [ ] Publish to Test PyPI: `twine upload --repository testpypi dist/*`
- [ ] Test installation from Test PyPI
- [ ] Run smoke tests on Test PyPI package
- [ ] Fix any issues
- [ ] Publish to PyPI: `twine upload dist/*`
- [ ] Verify package appears on PyPI
- [ ] Test installation from PyPI
- [ ] Verify package metadata on PyPI

### 12.7: Communication
- [ ] Update documentation site (if applicable)
- [ ] Write blog post/announcement
- [ ] Update GitHub repository description
- [ ] Update README badges
- [ ] Post announcement on social media
- [ ] Notify users via email/newsletter
- [ ] Post in community forums
- [ ] Close v2.0 milestone on GitHub

**Phase 12 Sign-off**: ___________  
**Date**: ___________

---

## Post-Release Tasks

### Monitoring
- [ ] Monitor for bug reports
- [ ] Monitor installation issues
- [ ] Monitor performance issues
- [ ] Monitor GitHub issues

### Support
- [ ] Answer user questions
- [ ] Create FAQ based on questions
- [ ] Update documentation based on feedback
- [ ] Plan v2.1 based on feedback

### v1.x Maintenance
- [ ] Create v1.x maintenance branch
- [ ] Plan security fix releases for v1.x (6 months)
- [ ] Document v1.x support policy

---

## Success Criteria

### Technical
- [x] All 12 phases completed
- [ ] >80% code coverage
- [ ] All tests passing
- [ ] No critical bugs
- [ ] Performance within targets
- [ ] Security audit passed

### Documentation
- [ ] All public APIs documented
- [ ] Migration guide completed
- [ ] All examples working
- [ ] CHANGELOG comprehensive
- [ ] Release notes published

### Release
- [ ] Package published to PyPI
- [ ] Documentation deployed
- [ ] Release announced
- [ ] Git tags created
- [ ] GitHub release created

---

## Notes

### Blocked Items
_Document any blocked tasks here with reasons and expected resolution_

### Issues Found
_Document any issues discovered during implementation_

### Decisions Made
_Document any architectural or design decisions made_

### Performance Results
_Document key performance metrics here_

---

**Checklist Version**: 1.0  
**Last Updated**: November 20, 2025  
**Progress**: 0% (0/12 phases completed)
